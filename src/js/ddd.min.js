/*!
 * dddrawings - v1.0.0
 * Data Driven Drawings JS library
 * April 24, 2017
 * https://github.com/1cgonza/dddrawings
 * Juan Camilo Gonzalez <info@juancgonzalez.com> (http://juancgonzalez.com)
 */
!function(t){function e(r){if(i[r])return i[r].exports;var n=i[r]={exports:{},id:r,loaded:!1};return t[r].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){(function(t){"use strict";function e(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}var r=i(1),n=e(r),s=i(7),o=e(s),a=i(9),h=e(a),u=i(10),c=e(u),d=i(11),l=e(d),f=i(12),p=e(f),y=i(13),m=e(y);t.DDD=Object.assign(n,o,c,h,l,p,m)}).call(e,function(){return this}())},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function n(t,e,i){var r=Math.floor(Math.random()*(e-t))+t;return i&&(r=Math.random()*(e-t)+t),r}function s(t,e){return t/100*e}function o(t,e){return t/e*100}function a(t,e){return t>0&&0===(t&t-1)&&e>0&&0===(e&e-1)}Object.defineProperty(e,"__esModule",{value:!0}),e.Vector=e.Matrix=e.Rectangle=e.Point=e.Transform=e.toRad=e.QUARTER_PI=e.TWO_PI=e.PI=void 0,e.random=n,e.sizeFromPercentage=s,e.getPercent=o,e.isPowerOfTwo=a;var h=i(2),u=r(h),c=i(3),d=r(c),l=i(4),f=r(l),p=i(5),y=r(p),m=i(6),v=r(m),x=e.PI=Math.PI;e.TWO_PI=2*x,e.QUARTER_PI=x/4,e.toRad=x/180;e.Transform=v.default,e.Point=u.default,e.Rectangle=d.default,e.Matrix=f.default,e.Vector=y.default},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e){this.x=t||0,this.y=e||0};e.default=i,i.prototype.clone=function(){return new i(this.x,this.y)},i.prototype.copy=function(t){this.set(t.x,t.y)},i.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},i.prototype.set=function(t,e){this.x=t||0,this.y=e||0!==e?this.x:0}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e,i,r){this.x=t||0,this.y=e||0,this.width=i||0,this.height=r||0};e.default=i},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=i(2),s=r(n),o=function(t,e,i,r,n,s){this.a=t||1,this.b=e||0,this.c=i||0,this.d=r||1,this.tx=n||0,this.ty=s||0};e.default=o,o.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},o.prototype.apply=function(t,e){e=e||new s.default;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},o.prototype.applyInverse=function(t,e){e=e||new s.default;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},o.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},o.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},o.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},o.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},o.prototype.setTransform=function(t,e,i,r,n,s,o){var a=Math.sin(o),h=Math.cos(o),u=h*n,c=a*n,d=-a*s,l=h*s;return this.a=u+d,this.b=c+l,this.c=u+d,this.d=c+l,this.tx=t+(i*u+r*d),this.ty=e+(i*c+r*l),this},o.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},o.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},o.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},o.prototype.clone=function(){var t=new o;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},o.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0};e.default=i,i.prototype.set=function(t,e,i){return this.x=t,this.y=e,this.z=i,this},i.prototype.setX=function(t){return this.x=t,this},i.prototype.setY=function(t){return this.y=t,this},i.prototype.setZ=function(t){return this.z=t,this},i.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},i.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},i.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},i.prototype.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},i.prototype.subVectors=function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},i.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},i.prototype.multiplyScalar=function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},i.prototype.multiplyVectors=function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},i.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},i.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},i.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},i.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},i.prototype.setLength=function(t){return this.multiplyScalar(t/this.length())},i.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},i.prototype.normalize=function(){return this.divideScalar(this.length())},i.prototype.distanceToSquared=function(t){var e=this.x-t.x,i=this.y-t.y,r=this.z-t.z;return e*e+i*i+r*r},i.prototype.limit=function(t){return this.lengthSq()>t*t&&(this.normalize(),this.mult(t)),this},i.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){this.reset()};e.default=i,i.prototype.reset=function(){this.m=[1,0,0,1,0,0]},i.prototype.multiply=function(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],i=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],n=this.m[1]*t.m[2]+this.m[3]*t.m[3],s=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],o=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];this.m[0]=e,this.m[1]=i,this.m[2]=r,this.m[3]=n,this.m[4]=s,this.m[5]=o},i.prototype.invert=function(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,i=-this.m[1]*t,r=-this.m[2]*t,n=this.m[0]*t,s=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=e,this.m[1]=i,this.m[2]=r,this.m[3]=n,this.m[4]=s,this.m[5]=o},i.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.m[0]*e+this.m[2]*i,n=this.m[1]*e+this.m[3]*i,s=this.m[0]*-i+this.m[2]*e,o=this.m[1]*-i+this.m[3]*e;this.m[0]=r,this.m[1]=n,this.m[2]=s,this.m[3]=o},i.prototype.translate=function(t,e){this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e},i.prototype.translateAndRotate=function(t,e,i){var r=Math.cos(i),n=Math.sin(i),s=this.m[0]*r+this.m[2]*n,o=this.m[1]*r+this.m[3]*n,a=this.m[0]*-n+this.m[2]*r,h=this.m[1]*-n+this.m[3]*r;this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this.m[0]=s,this.m[1]=o,this.m[2]=a,this.m[3]=h},i.prototype.scale=function(t,e){this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e},i.prototype.transformPoint=function(t,e){var i=t,r=e;return t=i*this.m[0]+r*this.m[2]+this.m[4],e=i*this.m[1]+r*this.m[3]+this.m[5],[t,e]}},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function n(t,e,i,r,n){var s=document.createElement("ul"),o="";s.id="years",s.style.zIndex=99999;for(var a=t;a<=e;a++){var h=document.createElement("li"),u=document.createTextNode(a);a===i&&(h.className="current",o=h),h.appendChild(u),s.appendChild(h),h.addEventListener("click",r,!1)}n(s,o)}function s(t,e,i){i=i||"current",t&&t.classList.remove(i),e.classList.add(i)}function o(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="",r=0;r<t.length;){var n,s,o=255&t.charCodeAt(r++),a=255&t.charCodeAt(r++),h=255&t.charCodeAt(r++),u=o>>2,c=(3&o)<<4|a>>4;isNaN(a)?n=s=64:(n=(15&a)<<2|h>>6,s=isNaN(h)?64:63&h),i+=e.charAt(u)+e.charAt(c)+e.charAt(n)+e.charAt(s)}return i}Object.defineProperty(e,"__esModule",{value:!0}),e.canvas=void 0,e.yearsMenu=n,e.resetCurrent=s,e.base64=o;var a=i(8),h=r(a);e.canvas=h.default},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var i=document.createElement("canvas"),r=i.getContext("2d");if(e=e||{},i.width=e.w||window.innerWidth,i.height=e.h||window.innerHeight,i.style.position=e.position||"absolute",i.style.top=e.top||0,i.style.left=e.left||0,i.style.zIndex=e.zi||9,e.css)for(var n in e.css)i.style[n]=e.css[n];return r.font=e.font||"12px Inconsolata",t&&t.appendChild(i),{container:t,canvas:i,w:i.width,h:i.height,ctx:r,center:{x:i.width/2,y:i.height/2}}}},function(t,e){"use strict";function i(t){var e=new o;return e.json(t)}function r(t){var e=new o;return e.req.overrideMimeType("text/plain; charset=x-user-defined"),e.getD(t).then(function(t){return void 0!==t.ret?t:t.data}).catch(function(t){console.error(t)})}function n(t){var e=new o;return e.req.responseType="arraybuffer",e.getD(t).then(function(t){return t}).catch(function(t){console.error("Error fetching audio file",t)})}Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.json=i,e.image=r,e.audio=n;var o=function(){this.req=new XMLHttpRequest};e.DataRequest=o,o.prototype.abort=function(){this.req.abort()},o.prototype.json=function(t){return this.req.overrideMimeType("application/json"),this.getD(t).then(function(t){return void 0!==t.ret?(t.data=JSON.parse(t.data),t):JSON.parse(t.data)}).catch(function(t){console.error("Error in data request, reason:",t)})},o.prototype.getD=function(t){function e(){f.style.opacity=1,d.style.zIndex=9,n=f.querySelector(".loading-msg"),n||(n=document.createElement("p"),n.className="loading-msg",n.innerText=u,f.appendChild(n))}function i(t){if(t.lengthComputable){a||(o=f.querySelector(".progress"),o||(o=document.createElement("progress"),o.className="progress",o.style.zIndex=0,o.max=100,o.value=0,f.insertBefore(o,n),a=!0));var e=t.loaded/t.total*100;o.value=e,n.innerText=Math.floor(e)+"%\n"+u}else h.onprogress=null}function r(){l||(f.style.display="none"),d.style.zIndex=0}if("object"===("undefined"==typeof t?"undefined":s(t))){if(!t.url)return void console.error("The request did not receive a url, instead got",t.url)}else"string"==typeof t&&t.length>0&&(t={url:t});var n,o,a=!1,h=this.req,u=t.loadingMsg||"Loading",c=t.container||document.body,d=c.querySelector(".loading");d||(d=document.createElement("div"),d.className="loading",c.appendChild(d));var l=!!t.loadingEle,f=l?t.loadingEle:null;if(!f){var p=c.querySelector(".loading-ele");f=document.createElement("div"),f.className="loadingEle",p?d.insertBefore(p,f):d.appendChild(f)}return new Promise(function(n,s){h.open("GET",t.url,!0),h.onloadstart=e,h.onprogress=i,h.onloadend=r,h.onload=function(){200===h.status?n({data:h.response,ret:t.ret}):s(h.statusText)},h.onerror=function(){s("Network Error")},h.send(null)})}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Map=void 0;var r=i(1),n=function(t){var e=t.width||window.innerWidth,i=t.height||window.innerHeight,r=t.zoom||11;t.center?this.center={lon:t.center.lon,lat:t.center.lat}:this.center={},this.hasCenter=null,this.updateSize(e,i,r)};e.Map=n,n.prototype.updateSize=function(t,e,i){this.stageWidth=t,this.stageCenterY=e/2,this.zoom=i||this.zoom,this.zoomX=this.stageWidth*this.zoom,this.zoomY=this.stageCenterY*this.zoom,this.zoomRad=this.zoomX/360,this.newCenter(this.center.lon,this.center.lat)},n.prototype.newCenter=function(t,e){this.hasCenter=!1,this.convertCoordinates(t,e),this.hasCenter=!0},n.prototype.convertCoordinates=function(t,e){var i=+e*r.toRad,n=Math.log(Math.tan(r.QUARTER_PI+i/2)),s=(+t+180)*this.zoomRad,o=this.zoomY-this.zoomX*n/r.TWO_PI;return this.hasCenter?(s-=this.center.x,o-=this.center.y):(this.center.x=s,this.center.y=o),{x:s,y:o}}},function(t,e){"use strict";function i(t,e,i){return"0x"+((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1)}function r(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,function(t,e,i,r){return e+e+i+i+r+r});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}function n(t){var e=255/t,i=1/e;return i}function s(t,e){return"rgba("+t.r+","+t.g+","+t.b+","+e+")"}Object.defineProperty(e,"__esModule",{value:!0}),e.rgbToHex=i,e.hexToRgb=r,e.convertAlpha=n,e.getRGBA=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Audio=void 0;var r=i(9),n=function(t,e){function i(t,e){function i(t){if(!t)return void console.error("Error decoding audio file:",e);var i=this.ctx.createBufferSource();i.buffer=t,a[e]=i,n()}function r(t){console.error("decodeAudioData error",t)}var s=this;this.ctx.decodeAudioData(t,i.bind(s),r)}function n(){o++,o===s&&e(a)}if(!t||"[object Object]"!==Object.prototype.toString.call(t))return console.error("The first parameter needs to be an Object.","Example:","{audio1: 'audio1.mp3', audio2: 'audio2.mp3'}");window.AudioContext=window.AudioContext||window.webkitAudioContext;var s=Object.keys(t).length,o=0,a={};this.ctx=new AudioContext;for(var h in t)(0,r.audio)(t[h],i.bind(this),h,document.body,"Loading Audio")};e.Audio=n,n.prototype.source=function(t){var t=this.ctx.createBufferSource();return t.buffer=buffer,t.connect(this.gainNode),this.gainNode.connect(this.ctx.destination),t}},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Webgl=e.Stage=void 0;var n=i(14),s=r(n),o=i(15),a=r(o);e.Stage=s.default,e.Webgl=a.default},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),s=i(2),o=r(s),a=function(t,e,i){this.children=[],this.texture={},this.data=t,this.renderer=e,this.loadImg(t.url),this.setBatchSize(i)};e.default=a,a.prototype.setBatchSize=function(t){var e=16384,i=15e3;t>e&&(t=e),t>i&&(t=i),this.batchSize=t},a.prototype.renderWebGL=function(t){t.currentRenderer.render(this)},a.prototype.bindTexture=function(){var t=this.renderer.gl,e=this.texture;return e.glTexture||(e.glTexture=t.createTexture()),t.bindTexture(t.TEXTURE_2D,e.glTexture),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.img),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),e.mipmap&&e.isPowerOfTwo?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.generateMipmap(t.TEXTURE_2D)):t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),e.isPowerOfTwo?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),!0},a.prototype.loadImg=function(t){this.img=new Image,this.img.onload=this.imgLoaded.bind(this),this.img.src=t},a.prototype.imgLoaded=function(){for(var t=this.img.naturalWidth,e=this.img.naturalHeight,i={loaded:!0,isPowerOfTwo:(0,n.isPowerOfTwo)(t,e)},r=[],s=0;s<this.data.frames.length;s++){var o=this.data.frames[s];r.push({width:o.w,height:o.h,uvs:[o.x/t,o.y/e,(o.x+o.w)/t,(o.y+o.h)/e]})}this.renderer.frames=r,this.texture=i,this.bindTexture(),this.data.cb&&this.data.cb()},a.prototype.particle=function(t){return t=t||{},t.scale=t.scale||new o.default(1,1),t.alpha=t.alpha||1,t.rotation=t.rotation||0,t.x=t.x||0,t.y=t.y||0,t.frame=t.frame||0,this.children.push(t),this.children.length>this.batchSize&&this.setBatchSize(this.children.length),t}},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=i(16),s=r(n),o=i(17),a=r(o),h=function(t,e){this.container=t,e=e||{},this.width=e.width||window.innerWidth,this.height=e.height||window.innerHeight,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",t.appendChild(this.canvas);var i=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl",ctxOptions);this.gl=i,i.disable(i.DEPTH_TEST),i.disable(i.CULL_FACE),i.enable(i.BLEND),this.renderTarget=new s.default(i,this.width,this.height),this.currentRenderer=new a.default(i,this),this.resize(this.width,this.height)};e.default=h,h.prototype.render=function(t){t.renderWebGL(this)},h.prototype.resize=function(t,e){this.width=this.canvas.width=t,this.height=this.canvas.height=e,this.gl.viewport(0,0,t,e)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),n=function(t,e,i){this.gl=t,this.size=new r.Rectangle(0,0,1,1),this.projectionMatrix=new r.Matrix,this.resize(e,i)};e.default=n,n.prototype.resize=function(t,e){if(t|=0,e|=0,this.size.width!==t||this.size.height!==e){this.size.width=t,this.size.height=e;var i=this.projectionMatrix.identity();i.a=2/this.size.width,i.d=-2/this.size.height,i.tx=-1,i.ty=1}}},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=i(18),s=r(n),o=function(t,e){this.renderer=e,this.gl=t,this.start()};e.default=o,o.prototype.start=function(){var t=this.gl,e=new s.default(t);this.properties=[{attribute:e.attributes.aVertexPosition,size:2},{attribute:e.attributes.aPositionCoord,size:2},{attribute:e.attributes.aRotation,size:1},{attribute:e.attributes.aTextureCoord,size:2},{attribute:e.attributes.aAlpha,size:1}];for(var i=0;i<this.properties.length;i++)t.enableVertexAttribArray(i);var r=this.renderer.renderTarget.projectionMatrix;t.uniformMatrix3fv(e.uniforms.projectionMatrix._location,!1,r.toArray(!0))},o.prototype.render=function(t){var e=(t.texture,t.children),i=e.length,r=t.maxSize;this.size=t.batchSize;var n=this.gl;if(0!==i){if(i>r&&(i=r),!this.data){this.initBuffers();for(var s=0;s<this.properties.length;s++){var o=this.properties[s];n.vertexAttribPointer(o.attribute,o.size,n.FLOAT,!1,4*this.stride,4*o.offset)}}this.updateData(e,i),n.bufferSubData(n.ARRAY_BUFFER,0,this.data),n.drawElements(n.TRIANGLES,6*i,n.UNSIGNED_SHORT,0)}},o.prototype.initBuffers=function(){var t=this.gl,e=0;this.stride=0;for(var i=0;i<this.properties.length;i++){var r=this.properties[i];r.offset=e,e+=r.size,this.stride+=r.size}this.data=new Float32Array(this.size*this.stride*4),t.bindBuffer(t.ARRAY_BUFFER,t.createBuffer()),t.bufferData(t.ARRAY_BUFFER,this.data,t.DYNAMIC_DRAW);for(var n=6*this.size,s=new Uint16Array(n),i=0,o=0;i<n;i+=6,o+=4)s[i]=o,s[i+1]=o+1,s[i+2]=o+2,s[i+3]=o,s[i+4]=o+2,s[i+5]=o+3;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,t.createBuffer()),t.bufferData(t.ELEMENT_ARRAY_BUFFER,s,t.STATIC_DRAW)},o.prototype.updateData=function(t,e){for(var i=(this.stride,0),r=this.data,n=this.renderer.frames,s=0;s<e;s++){var o=t[s],a=n[o.frame],h=a.width*o.scale,u=a.height*o.scale,c=o.x,d=o.y,l=o.rotation,f=a.uvs,p=o.alpha;r[i]=-h,r[++i]=-u,r[++i]=c,r[++i]=d,r[++i]=l,r[++i]=f[0],r[++i]=f[1],r[++i]=p,r[++i]=h,r[++i]=-u,r[++i]=c,r[++i]=d,r[++i]=l,r[++i]=f[2],r[++i]=f[1],r[++i]=p,r[++i]=h,r[++i]=u,r[++i]=c,r[++i]=d,r[++i]=l,r[++i]=f[2],r[++i]=f[3],r[++i]=p,r[++i]=-h,r[++i]=u,r[++i]=c,r[++i]=d,r[++i]=l,r[++i]=f[0],r[++i]=f[3],r[++i]=p,i++}}},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=i(19),s=r(n),o=i(20),a=r(o),h=function(t){this.gl=t,this.uniforms={projectionMatrix:{}},this.attributes={};var e=t.createShader(t.VERTEX_SHADER);t.shaderSource(e,s.default),t.compileShader(e);var i=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(i,a.default),t.compileShader(i);var r=t.createProgram();t.attachShader(r,e),t.attachShader(r,i),t.linkProgram(r),t.deleteShader(e),t.deleteShader(i),this.program=r,t.useProgram(r),this.cacheUniformLocations(["projectionMatrix"]),this.cacheAttributeLocations(["aVertexPosition","aTextureCoord","aAlpha","aPositionCoord","aRotation"])};e.default=h,h.prototype.cacheUniformLocations=function(t){for(var e=0;e<t.length;++e)this.uniforms[t[e]]._location=this.gl.getUniformLocation(this.program,t[e])},h.prototype.cacheAttributeLocations=function(t){for(var e=0;e<t.length;++e)this.attributes[t[e]]=this.gl.getAttribLocation(this.program,t[e])}},function(t,e){t.exports="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute float aAlpha;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying float vAlpha;\n\nvoid main(void){\n  float cosine = cos(aRotation);\n  float sine = sin(aRotation);\n\n  vec3 v;\n  v.x = aVertexPosition.x * cosine - aVertexPosition.y * sine;\n  v.y = aVertexPosition.x * sine + aVertexPosition.y * cosine;\n  v.z = 1.0;\n\n  // Move\n  v.xy += aPositionCoord;\n\n  gl_Position = vec4(projectionMatrix * v, 1.0);\n\n  vTextureCoord = aTextureCoord;\n  vAlpha = aAlpha;\n}"},function(t,e){t.exports="precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying float vAlpha;\n\nuniform sampler2D uImage;\n\nvoid main(void){\n  vec4 color = texture2D(uImage, vTextureCoord) * vAlpha;\n  if (color.a == 0.0) discard;\n  gl_FragColor = color;\n}"}]);
//# sourceMappingURL=ddd.min.js.map